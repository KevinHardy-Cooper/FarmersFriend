<!DOCTYPE html>
<html>
	<head>

		<!-- Character encoding -->
		<meta charset = "UTF-8"/>

		<!-- Assisting with scaling from desktop to mobile, inspired by https://www.w3schools.com/css/css_rwd_viewport.asp -->
		<meta name = "viewport" content = "width = device-width, initial-scale = 1"/>
		
		<!-- Page author -->
		<meta name = "author" content = "Kevin Hardy-Cooper"/>

		<!-- Page description -->
		<meta name = "description" content = "Farm page with reviews"/>

		<!-- Title of the page -->
		<title>Farmer's Friend</title>

		<!-- Importing external stylesheet -->
		<link href="stylesheets/global.css" type="text/css" rel="stylesheet"/>
		<link href="stylesheets/specificObject.css" type="text/css" rel="stylesheet"/>

		<!-- Embedded map -->
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin=""/>
		<script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>
	</head>
	<body>
		<header>
			<!-- Navbar -->
			<nav>
				<ul>
					<li class = "justify-left">
						<a href = "index.html">
							Farmer's Friend
						</a>
					</li>
					<li class = "justify-right">
						<a href = "sign_in.html">
							Sign In
						</a>
					</li>
					<li class = "justify-right">
						<a href = "registration.html">
							Sign Up
						</a>
					</li>
					<li class = "justify-right">
						<a href = "submission.html">
							Register Farm
						</a>
					</li>
					<li class = "justify-right">
						<a href = "search.html">
							Search
						</a>
					</li>
				</ul>
			</nav>
		</header>

		<!-- Skipping some lines for formatting -->
		<br>
		<br>

		<main>
			<article>

				<!-- Part 3 of the Meta-data add-on task, inspired by "http://schema.org/Place" -->
				<div itemscope itemtype="http://schema.org/Place">

					<div class = "specific-padding">

						<!-- Specific Object's name -->
						<h3>
							<span itemprop = "name" id = "farm-name"></span>
						</h3>

						<picture>

							<!-- Image of farm -->
							<img class = "user-farm-image" alt = "User-uploaded image of farm" src = "assets/img/two-silos.jpg"/>
						</picture>

						<!-- Specific Object\s description -->
						<p>
							<span itemprop = "description" id  = "description"></span>
						</p>
						<div itemprop = "geo" itemscope itemtype = "http://schema.org/GeoCoordinates" id = "farm-coords"></div>
						<br>
						<div id = "farm-av-rating"></div>
						<br>
						<br>
					</div>
				</div>
			</article>	

			<!-- <div> that our map will be loaded into -->
			<div id="objectMap"></div>
		
			<article>

				<h3 class = "specific-padding">
					Reviews
				</h3>

				<!-- Part 3 of the Meta-data add-on task, inspired by "http://schema.org/Review" -->
				
				<!-- Table containing returned reviews and data about these reviews -->
				<div class = "specific-padding scrollable-div">
					
						<table class = "table" id = "reviewTable">
							<!-- <tr>
								<th>Review</th>
								<th>Date</th>
								<th>Rating</th>
								<th>Reviewed By</th>
							</tr>
							
							<tr>
								<td>
									Wow so great
								</td>
								<td>January 9th, 2018</td>
								<td>
									5 stars
								</td>
								<td>
									Not Not Farmer Kev
								</td>
							</tr>
							<tr>
								<td>
									Great so wow
								</td>
								<td>January 10th, 2018</td>
								<td>
									5 stars
								</td>
								<td>
									Not Not Not Not Farmer Kev
								</td>
							</tr>
							<tr>
								<td>
									Gee whiz I loves me their pork tenderloin!!!
								</td>
								<td>January 9th, 2018</td>
								<td>
									5 stars
								</td>
								<td>
									 The Neighbour
								</td>
							</tr>
							<tr>
								<td>
									OMG THIS FARM IS SO QUAINT
								</td>
								<td>January 9th, 2018</td>
								<td>
									5 stars
								</td>
								<td>
									 Citiot
								</td>
							</tr> -->
						</table>	
					</div>
			</article>
		</main>

		<!-- Footer -->
		<footer>
			<p> 
				Made with 
				<picture>
					<source srcset = "assets/img/corn.png">
					<img alt = "Corn" class = "footer-emoji" src = "assets/img/corn.png"/> 
				</picture>
				&nbsp;by Kevin Hardy-Cooper &copy; 2018
			</p>
		</footer>
	</body>
</html>
<script>

	// dummy array that will contain lats and lngs of farms
	var farmLatLng = [43.260659, -79.921782];

	// dummy array that will contain sample reviews
	var farmReviews = [
		{
			review: {
				content: "Wow so great",
				date: "January 9th, 2018",
				rating: "5 stars",
				reviewer: "Not Not Farmer Kev"
			}
		},
		{
			review: {
				content: "Great so wow",
				date: "January 10th, 2018",
				rating: "5 stars",
				reviewer: "Not Not Not Not Farmer Kev"
			}
		},
		{
			review: {
				content: "Gee whiz I loves me their pork tenderloin!!!",
				date: "January 9th, 2018",
				rating: "5 stars",
				reviewer: "The Neighbour"
			}
		},
		{
			review: {
				content: "OMG THIS FARM IS SO QUAINT",
				date: "January 9th, 2018",
				rating: "5 stars",
				reviewer: "Citiot"
			}
		},
	];

	// dummy data to populate sample page
	var farmName = "Farmer Kev's Farm";
	var farmDescr = "Hobby farm that sells free-range eggs and more than enough swiss chard.";
	var farmAvRating = "Average Rating: 5 stars";

	// creates map element
	createMap(farmLatLng);

	// setting information for the farm onto the page
	setFarmInfo(farmName, farmDescr, farmAvRating, farmLatLng);
	
	// populating the table
	populateTable(farmReviews);

	function setFarmInfo(farmName, farmDescr, farmAvRating, farmLatLng) {
		document.getElementById("farm-name").innerHTML = farmName;
		document.getElementById("description").innerHTML = farmDescr;
		document.getElementById("farm-coords").innerHTML = "Coordinates: " + farmLatLng;
		document.getElementById("farm-av-rating").innerHTML = farmAvRating;
	}

	function createMap(farmLatLng) {

		// create the map and load it into the div with id="mymap"
		var objectMap = L.map('objectMap');

		// use the OpenStreetMaps tiles
		L.tileLayer(
			'https://a.tile.openstreetmap.org/{z}/{x}/{y}.png',
			{
				attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
				'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'
			}
		).addTo(objectMap);

		// TODO: centre the map around farm
		objectMap.setView(farmLatLng, 14);

		// create a map marker for the farm
		L.marker(farmLatLng)
			.addTo(objectMap)

			// include a pop-up for the marker that contains the farm's name
			.bindPopup("<b>Farmer Kev's Farm</b>")
			.openPopup();
	}

	function populateTable(farmReviews) {
		var table = document.getElementById("reviewTable");
		for (var review in farmReviews) {
			var row = createRow(farmReviews[review].review);
			table.appendChild(row);
		}
	}

	function createRow(review) {
		var row = document.createElement("tr");
		for (var key in review) {
			var td = createCell(review[key]);
			row.appendChild(td);
		}
		return row;
	}
	function createCell(content) {
		var td = document.createElement("td");
		td.innerHTML = content;
		return td;
	}
</script>